<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.12.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="蚂蚁的博客">
<meta property="og:url" content="http://example.com/page/33/index.html">
<meta property="og:site_name" content="蚂蚁的博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="mayi">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/33/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/33/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>蚂蚁的博客</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">蚂蚁的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">mayi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">373</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">37</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/15/yuque/%E5%8D%8E%E4%B8%BA%E7%B3%BB%E5%88%97%E6%95%85%E4%BA%8B%E8%AF%BB%E5%90%8E%E6%84%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mayi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/15/yuque/%E5%8D%8E%E4%B8%BA%E7%B3%BB%E5%88%97%E6%95%85%E4%BA%8B%E8%AF%BB%E5%90%8E%E6%84%9F/" class="post-title-link" itemprop="url">华为系列故事读后感</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-15 12:38:55" itemprop="dateCreated datePublished" datetime="2021-03-15T12:38:55+08:00">2021-03-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-06-29 11:46:40" itemprop="dateModified" datetime="2022-06-29T11:46:40+08:00">2022-06-29</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>看完两本华为成长故事《枪林弹雨中成长》、《厚积薄发》有些感触，记录下来</p>
</blockquote>
<p>枪林弹雨中成长，讲述华为各个角色员工在非洲、在中东艰苦地区，冒着巨大风险，开拓市场、服务用户的故事。有项目经理、交付、行政、厨师，每个角色背后的人把他感受到的环境，做出的选择，采取的行动记录下来。为客户创造价值、为公司创造利润，不管什么困难，都困不住他们。</p>
<blockquote>
<p>在艰苦和危险地区，内部简单，所有人对着一个城墙口冲锋，目标明确，价值分配到位，支撑大家坚持下来。</p>
</blockquote>
<p>厚积薄发一书，主要讲华为在研发方面的突破。通过饱和攻击，攻下技术山头。</p>
<p>蓬生麻中，不扶自直。<br>人生攒满了回忆就是幸福。在非洲，身体直接感受环境艰苦，精神直接感受成功的喜悦，留下了最深的回忆。<br>患难见真情。基于性情的合作持久且牢固，比如三国时的刘关张，经历了 18 年的游击战，还坚持一起，开创了一番事业。次之的是基于信仰、基于利益、基于规则。</p>
<p>火车头，加满油。基于利益的驱动，能有所成就。不是火车头，加再多的油都不能带队向前冲。利益激励和考核，要加在特定角色上，能带领业务发展的角色。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/15/yuque/%E6%B2%A1%E6%9C%89%E4%BA%BA%E6%98%AF%E4%B8%80%E5%BA%A7%E5%AD%A4%E5%B2%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mayi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/15/yuque/%E6%B2%A1%E6%9C%89%E4%BA%BA%E6%98%AF%E4%B8%80%E5%BA%A7%E5%AD%A4%E5%B2%9B/" class="post-title-link" itemprop="url">没有人是一座孤岛</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-15 09:11:35" itemprop="dateCreated datePublished" datetime="2021-03-15T09:11:35+08:00">2021-03-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-06-29 11:46:40" itemprop="dateModified" datetime="2022-06-29T11:46:40+08:00">2022-06-29</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>你的孩子，并不是你的孩子<br>他们是由生命本身的渴望而诞生的孩子<br>他们借助你来到这世界，却非因你而来<br>他们在你身旁，却并不属于你<br>你可以给与他们的是你的爱，而不是你的想法<br>因为他们有自己的思想<br>你可以庇护的是他们的身体，而不是他们的灵魂<br>因为他们的灵魂属于明天<br>属于你做梦也无法到达的明天<br>…<br>纪伯伦《孩子》</p>
</blockquote>
<p>看了春藤的推荐文章，对这段很有感触，和妹子说了好几遍。<br>《园丁与木匠》像是在践行这段诗，并给出一些方法。养孩子应该是给他们合适的环境，让他们尽情生长，而不是把他们塑造成你期望他们成为的样子。要像园丁，不要做木匠。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/08/yuque/%E5%A5%BD%E7%A8%8B%E5%BA%8F%E5%91%98%20VS%20%E5%A5%BD%E8%BF%90%E7%BB%B4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mayi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/08/yuque/%E5%A5%BD%E7%A8%8B%E5%BA%8F%E5%91%98%20VS%20%E5%A5%BD%E8%BF%90%E7%BB%B4/" class="post-title-link" itemprop="url">好程序员 VS 好运维</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-08 11:27:45" itemprop="dateCreated datePublished" datetime="2021-03-08T11:27:45+08:00">2021-03-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-06-29 11:46:40" itemprop="dateModified" datetime="2022-06-29T11:46:40+08:00">2022-06-29</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>看到<a target="_blank" rel="noopener" href="https://blog.hellojukay.cn/2017/09/22/20170922/#more">这篇文章</a>有感</p>
<p>文章指出，一种好程序员</p>
<blockquote>
<p>好的程序员，是能搞懂操作系统，计算机网络，编译原理，能写出非常炫酷的代码</p>
</blockquote>
<p>另一种好程序员</p>
<blockquote>
<p>对这些原理都不太懂，但是总是能用别人的框架完成自己的工作的。</p>
</blockquote>
<p>作者认为后一种程序员更好，因为能为企业创造直接的经济价值。<br>更好的程序员</p>
<blockquote>
<p>更好的程序员应该精通各种原理，同时又能快速的学习和使用各种框架，并别制作有经济价值的产品的程序员吧嗯，是的</p>
</blockquote>
<p>原理精通，快速学习框架工具，用优雅的方式创造产品，为企业创造价值。</p>
<p>那么，作为运维，什么是好的运维，什么是更好的运维呢？</p>
<p>在《软技能》一书中作者提出，软件开发人员售卖的就是他们把一个想法变成一个数字化现实产品的能力。运维人员售卖的是软件的保险，保障软件稳定运行。通过软件设计、运行环境高可用，可以让软件更健壮，不用买保险。所以运维就只有在更高层次上寻找价值：构建高效的软件开发和发布环境，提升软件生产效率；构建高可用的软件运行平台（成立小保险公司，为众多软件运行一起买保险）。对于直接面向消费者的产品，运维转变为站点稳定性工程师，对于面向公司的产品，运维转变为客户稳定性工程师。</p>
<p>程序员可以通过编写单元测试，验证程序的功能。运维人员怎么测试他售卖给软件的保险是有效的呢？软件系统运行，需要物理硬件、操作系统、中间件、代码，每个方面都要测试验证。奈飞淘气的猴子，就是一个好的测试员，自动制造可控的故障。</p>
<p>开发和运维，都可以加上“工程师”三个字，可见都是使用工程的方法和工具。回顾下吴军在《硅谷来信》中讲的工程师的 5 个层次，看清地图再出发。</p>
<blockquote>
<p>第五级： 能独立解决问题，完成工程工作；<br>第四级：能指导和带领其他人一同完成更有影响力的工作；<br>第三级：能独立设计和实现产品，并在市场上取得成功；<br>第二级：能设计和实现别人不能做出的产品，也就是说他的作用很难取代；<br>第一级：开创一个产业。</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/06/yuque/2021%E5%B9%B4windows10%20%E5%AE%89%E8%A3%85k8s%E6%96%B9%E6%B3%95%E8%B8%A9%E5%9D%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mayi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/06/yuque/2021%E5%B9%B4windows10%20%E5%AE%89%E8%A3%85k8s%E6%96%B9%E6%B3%95%E8%B8%A9%E5%9D%91/" class="post-title-link" itemprop="url">2021年windows10 安装k8s方法踩坑</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-06 15:25:41" itemprop="dateCreated datePublished" datetime="2021-03-06T15:25:41+08:00">2021-03-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-06-29 11:46:40" itemprop="dateModified" datetime="2022-06-29T11:46:40+08:00">2022-06-29</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>学习 k8s，需要一个好用的 k8s 集群。踩 windows10 minikube 各种坑，记录备忘。</p>
<h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><h3 id="1-windows10-hyper-v-minikube"><a href="#1-windows10-hyper-v-minikube" class="headerlink" title="1 windows10 + hyper-v + minikube"></a>1 windows10 + hyper-v + minikube</h3><p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/221687">参考链接</a><br>2017 年的文章，按照文章能安装成功，这个环境使用了 2 个月。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">管理员命令行启动minikube参数</span></span><br><span class="line">.\minikube.exe start  --image-mirror-country cn --iso-url=https://kubernetes.oss-cn-hangzhou.aliyuncs.com/minikube/iso/minikube-v1.16.0.iso  --registry-mirror=https://reg-mirror.qiniu.com --vm-driver=&quot;hyperv&quot; --hyperv-virtual-switch=&quot;MinikubeSwitch&quot; --memory=2048</span><br></pre></td></tr></table></figure>

<p>hyper-v 重装后，虚拟交换机初始化一直报错，还导致 wls2 中的 ubuntu 异常。遂放弃。wls 也换回版本 1.</p>
<h3 id="2-windows10-virtualbox6-12-minikube1-81"><a href="#2-windows10-virtualbox6-12-minikube1-81" class="headerlink" title="2 windows10 + virtualbox6.12 +minikube1.81"></a>2 windows10 + virtualbox6.12 +minikube1.81</h3><p><a target="_blank" rel="noopener" href="https://yq.aliyun.com/articles/750687">参考链接</a><br><a target="_blank" rel="noopener" href="https://storage.googleapis.com/minikube/releases/latest/minikube-installer.exe">minikube1.81 安装包</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动报错</span></span><br><span class="line">.\minikube.exe start   --iso-url=https://kubernetes.oss-cn-hangzhou.aliyuncs.com/minikube/iso/minikube-v1.18.0.iso  --registry-mirror=https://reg-mirror.qiniu.com --memory=2048  --driver=virtualbox</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>报错</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">! StartHost failed, but will try again: creating host: create: precreate: This computer doesn&#x27;t have VT-X/AMD-v enabled. Enabling it in the BIOS is mandatory</span><br></pre></td></tr></table></figure>

<p>报错网络设置异常，感觉是公司的安全管理系统影响网卡设置，遂放弃。</p>
<h3 id="3-windows10-virtualbox6-12-minikube1-73"><a href="#3-windows10-virtualbox6-12-minikube1-73" class="headerlink" title="3 windows10 + virtualbox6.12 + minikube1.73"></a>3 windows10 + virtualbox6.12 + minikube1.73</h3><p><a target="_blank" rel="noopener" href="https://download.virtualbox.org/virtualbox/6.1.18/VirtualBox-6.1.18-142142-Win.exe">virtualbox6.12 下载链接</a><br><a target="_blank" rel="noopener" href="https://github-releases.githubusercontent.com/56353740/6c861c80-537c-11ea-807a-d25dcd82b0ef?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A/20210306/us-east-1/s3/aws4_request&X-Amz-Date=20210306T072234Z&X-Amz-Expires=300&X-Amz-Signature=f9073744722af9c6c91c7161985f6ba1248b315e08c8e0337bd393e9f8fa4465&X-Amz-SignedHeaders=host&actor_id=0&key_id=0&repo_id=56353740&response-content-disposition=attachment;%20filename=minikube-windows-amd64.exe&response-content-type=application/octet-stream">minikube1.73 下载链接</a><br><a target="_blank" rel="noopener" href="https://storage.googleapis.com/kubernetes-release/release/v1.17.3/bin/windows/amd64/kubectl.exe?spm=a2c4e.10696291.0.0.7bf319a4erTSHS&file=kubectl.exe">windows kubectl.exe</a><br>放弃</p>
<h3 id="4-virtualbox6-12-centos7-6-手动安装-k8s-单机版"><a href="#4-virtualbox6-12-centos7-6-手动安装-k8s-单机版" class="headerlink" title="4 virtualbox6.12 + centos7.6 手动安装 k8s 单机版"></a>4 virtualbox6.12 + centos7.6 手动安装 k8s 单机版</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/telundusiji/article/details/114033799">https://blog.csdn.net/telundusiji/article/details/114033799</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Tempted/p/10671292.html">https://www.cnblogs.com/Tempted/p/10671292.html</a><br>在 virtualbox 中的 centos7.6 上安装 k8s。centos 虚拟机配置 2c2g，<a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaoxiangzi520/article/details/111291634">磁盘扩容到 20g</a></p>
<p>yum install bash-completion<br>source &lt;(kubectl completion bash)</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/04/yuque/k8s%20in%20action%20%E6%9C%8D%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="mayi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 蚂蚁的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/04/yuque/k8s%20in%20action%20%E6%9C%8D%E5%8A%A1/" class="post-title-link" itemprop="url">k8s in action 服务</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-04 09:06:38" itemprop="dateCreated datePublished" datetime="2021-03-04T09:06:38+08:00">2021-03-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-06-29 11:47:00" itemprop="dateModified" datetime="2022-06-29T11:47:00+08:00">2022-06-29</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>service，是在 pod 上层定义的资源对象，为了对集群内外部提供一个统一，稳定的访问入口。<br>为什么需要呢？<br>pod 短暂，ip 易变，服务使得水平伸缩不影响服务提供。</p>
<h3 id="在内部创建和测试服务"><a href="#在内部创建和测试服务" class="headerlink" title="在内部创建和测试服务"></a>在内部创建和测试服务</h3><p><img src="http://huilu-blog.colinspace.com//FgGjiAaZ37thC2MIKItP9blsazn4.png"><br>三种方式从集群内部测试服务</p>
<ol>
<li>创建一个 pod，从 pod 内部请求服务 cluster-ip，然后通过 pod 日志查看服务响应</li>
<li>使用 ssh 登陆 k8s 集群一个 node，使用 curl 命令</li>
<li>使用 kubectl exec 命令在集群已存在 pod 中执行 curl 命令</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl exec podname -- curl -s http://cluster-ip</span><br></pre></td></tr></table></figure>

<p>同一个服务可暴露多个端口，在 spec.ports 中写就行</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kubia</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">http</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8080</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">https</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">443</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8443</span></span><br></pre></td></tr></table></figure>

<p>如果在 pod 中给端口命名了，spec.containers.ports.name=http ,spec.containers.ports.containerPort=8080,在 service 中 targetPort 就可以直接用 port 的名字 。<br><img src="http://huilu-blog.colinspace.com//FoFrq3UeFpBstFORz3Sp6Fl_-8Wt.png"><br>pod 中的 client，或则 node 中的 curl 怎么发现服务呢，怎么通过 cluster-ip 访问到服务的呢？</p>
<ul>
<li>通过环境变量 <code>kubectl exec podname env</code></li>
<li>通过 DNS</li>
<li>通过 FQDN</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">kubectl</span> <span class="string">exec</span> <span class="string">-it</span> <span class="string">podname</span> <span class="string">bash</span></span><br><span class="line"><span class="comment">#容器中</span></span><br><span class="line"><span class="string">curl</span> <span class="string">http://kubia.default.svc.cluster.local</span></span><br><span class="line"><span class="string">curl</span> <span class="string">http://kubia.default</span></span><br><span class="line"><span class="string">curl</span> <span class="string">http://kubia</span></span><br><span class="line"><span class="comment"># 在Node中不能curl http://kubia 成功，原因为node不在pod的网络空间中。</span></span><br></pre></td></tr></table></figure>

<h3 id="连接集群外部的服务"><a href="#连接集群外部的服务" class="headerlink" title="连接集群外部的服务"></a>连接集群外部的服务</h3><p>endpoint 是暴露一个服务的 ip 地址和端口的列表。endpoint 是 service 之下的对象。2 步将外部服务引入集群内部，1 创建一个 endpoint，2 创建一个没有 pod 选择器的服务。选择第一步创建的 endpoint。配对通过 metadata 中的 name 匹配。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Endpoints</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">external-service</span></span><br><span class="line"><span class="attr">subsets:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">addresses:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">ip:</span> <span class="number">11.11</span><span class="number">.11</span><span class="number">.11</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">ip:</span> <span class="number">22.22</span><span class="number">.22</span><span class="number">.22</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">external-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>

<p><img src="http://huilu-blog.colinspace.com//FoU51EuMq2klcTCNRCw2tuACtikW.png"><br>还可以不创建 endpoint，直接为 service 指定 ExternalName，pod 可以通过 service.name 连接到外部服务。起作用的原因是 dns 添加了 CNAME 记录。CNAEME 只能指向域名，不能指向 ip。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">external-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ExternalName</span></span><br><span class="line">  <span class="attr">externalName:</span> <span class="string">someapi.somecompany.com</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>

<h3 id="将服务暴露给外部"><a href="#将服务暴露给外部" class="headerlink" title="将服务暴露给外部"></a>将服务暴露给外部</h3><ul>
<li>服务的类型设置为 NodePort</li>
<li>服务的类型设置为 LoadBalance</li>
<li>创建一个 Ingress 资源 ，通过一个 ip 地址公开多个服务，运行在 http 层。</li>
</ul>
<p>NodePort 示例</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kubia-nodeport</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8080</span></span><br><span class="line">      <span class="attr">Nodeport:</span> <span class="number">30123</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">kubia</span></span><br></pre></td></tr></table></figure>

<p>内部 pod 可以通过 clusterip：80，访问。集群外部可以通过 NodeIP：30123 访问，如果有多个 Node，每个 node 的 30123 端口都可以。<br><img src="http://huilu-blog.colinspace.com//Fs-60EuK99M_cLn2-kTSQkktX9nU.png"><br>负载均衡器暴露服务<br><img src="http://huilu-blog.colinspace.com//FqovedAmXde2hZ6SSmrnqyhbGuBo.png"></p>
<p>ingress 定义：进入或进入的行为。<br>为什么需要 ingress<br>每个 loadbalance 服务都需要自己的负载均衡器，以及独有的公网 ip 地址，而 Ingress 只需要一个公网 ip，就能为许多服务提供访问。<br><img src="http://huilu-blog.colinspace.com//FqGZ1VRTyYXYB3OQ5xj4-7Nb7EN4.png"></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kubia</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">kubia.ex.com</span></span><br><span class="line">      <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">kubia-nodeport</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>

<p>异常，需要手动启动 ingress 控制器<br><img src="http://huilu-blog.colinspace.com//Fk1DuI-qed7DrtUzP5gcHTt2bhHk.png"><br>使用 kubeadm 部署的集群需要手动启动 ingress 控制器</p>
<p>参考 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhanglianghhh/p/13721288.html">https://www.cnblogs.com/zhanglianghhh/p/13721288.html</a><br>完成 nginx 控制器部署，在集群内部，<br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/63558461/endpoints-default-http-backend-not-found-in-ingress-resource">https://stackoverflow.com/questions/63558461/endpoints-default-http-backend-not-found-in-ingress-resource</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/32/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><span class="page-number current">33</span><a class="page-number" href="/page/34/">34</a><span class="space">&hellip;</span><a class="page-number" href="/page/75/">75</a><a class="extend next" rel="next" href="/page/34/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">mayi</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
